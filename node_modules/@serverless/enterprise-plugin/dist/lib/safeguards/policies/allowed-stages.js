"use strict";

module.exports = function allowedStagePolicy(policy, service, options) {
  var stageName = service.provider.getStage();

  if (typeof options === 'string') {
    if (!stageName.match(options)) {
      policy.fail(`Stage name "${stageName}" not permitted by RegExp: "${options}"`);
    } else {
      policy.approve();
    }
  } else {
    for (var i in options) {
      if (options[i] === stageName) {
        policy.approve();
        return;
      }
    }

    policy.fail(`Stage name "${stageName}" not in list of permitted names: ${JSON.stringify(options)}`);
  }
};

module.exports.docs = 'https://git.io/fjfkp';
//# sourceMappingURL=allowed-stages.js.map