{"version":3,"sources":["../../../../src/lib/safeguards/policies/allowed-runtimes.js"],"names":["module","exports","allowedRuntimesPolicy","policy","service","allowedRuntimes","failed","fnName","declaration","functions","includes","runtime","provider","fail","JSON","stringify","approve","docs"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,SAASC,qBAAT,CAA+BC,MAA/B,EAAuCC,OAAvC,EAAgDC,eAAhD,EAAiE;AAChF,MAAIC,MAAM,GAAG,KAAb;;AACA,OAAK,IAAMC,MAAX,IAAqBH,OAAO,CAACI,WAAR,CAAoBC,SAApB,IAAiC,EAAtD,EAA0D;AACxD,QACE,CAACJ,eAAe,CAACK,QAAhB,CACCN,OAAO,CAACI,WAAR,CAAoBC,SAApB,CAA8BF,MAA9B,EAAsCI,OAAtC,IAAiDP,OAAO,CAACI,WAAR,CAAoBI,QAApB,CAA6BD,OAD/E,CADH,EAIE;AACAL,MAAAA,MAAM,GAAG,IAAT;AACAH,MAAAA,MAAM,CAACU,IAAP,CACG,uBAAsBN,MAAO,uCAAsCO,IAAI,CAACC,SAAL,CAClEV,eADkE,CAElE,EAHJ;AAKD;AACF;;AACD,MAAI,CAACC,MAAL,EAAa;AACXH,IAAAA,MAAM,CAACa,OAAP;AACD;AACF,CAnBD;;AAqBAhB,MAAM,CAACC,OAAP,CAAegB,IAAf,GAAsB,sBAAtB","sourcesContent":["module.exports = function allowedRuntimesPolicy(policy, service, allowedRuntimes) {\n  let failed = false\n  for (const fnName in service.declaration.functions || {}) {\n    if (\n      !allowedRuntimes.includes(\n        service.declaration.functions[fnName].runtime || service.declaration.provider.runtime\n      )\n    ) {\n      failed = true\n      policy.fail(\n        `Runtime of function ${fnName} not in list of permitted runtimes: ${JSON.stringify(\n          allowedRuntimes\n        )}`\n      )\n    }\n  }\n  if (!failed) {\n    policy.approve()\n  }\n}\n\nmodule.exports.docs = 'https://git.io/fjfkx'\n"],"file":"allowed-runtimes.js"}