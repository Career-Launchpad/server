{"version":3,"sources":["../../../../src/lib/safeguards/policies/required-stack-tags.js"],"names":["module","exports","requiredStackTagsPolicy","policy","service","requiredStackTags","failed","stackTags","declaration","provider","key","fail","match","approve","docs"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,SAASC,uBAAT,CAAiCC,MAAjC,EAAyCC,OAAzC,EAAkDC,iBAAlD,EAAqE;AACpF,MAAIC,MAAM,GAAG,KAAb;AACA,MAAMC,SAAS,GAAGH,OAAO,CAACI,WAAR,CAAoBC,QAApB,CAA6BF,SAA7B,IAA0C,EAA5D;;AACA,OAAK,IAAMG,GAAX,IAAkBL,iBAAlB,EAAqC;AACnC,QAAI,EAAEK,GAAG,IAAIH,SAAT,CAAJ,EAAyB;AACvBD,MAAAA,MAAM,GAAG,IAAT;AACAH,MAAAA,MAAM,CAACQ,IAAP,CAAa,sBAAqBD,GAAI,UAAtC;AACD,KAHD,MAGO,IAAI,CAACH,SAAS,CAACG,GAAD,CAAT,CAAeE,KAAf,CAAqBP,iBAAiB,CAACK,GAAD,CAAtC,CAAL,EAAmD;AACxDJ,MAAAA,MAAM,GAAG,IAAT;AACAH,MAAAA,MAAM,CAACQ,IAAP,CACG,sBAAqBD,GAAI,UAASH,SAAS,CAACG,GAAD,CAAM,2BAA0BL,iBAAiB,CAACK,GAAD,CAAM,EADrG;AAGD;AACF;;AACD,MAAI,CAACJ,MAAL,EAAa;AACXH,IAAAA,MAAM,CAACU,OAAP;AACD;AACF,CAjBD;;AAmBAb,MAAM,CAACC,OAAP,CAAea,IAAf,GAAsB,sBAAtB","sourcesContent":["module.exports = function requiredStackTagsPolicy(policy, service, requiredStackTags) {\n  let failed = false\n  const stackTags = service.declaration.provider.stackTags || {}\n  for (const key in requiredStackTags) {\n    if (!(key in stackTags)) {\n      failed = true\n      policy.fail(`Required stack tag ${key} not set`)\n    } else if (!stackTags[key].match(requiredStackTags[key])) {\n      failed = true\n      policy.fail(\n        `Required stack tag ${key} value ${stackTags[key]} does not match RegExp: ${requiredStackTags[key]}`\n      )\n    }\n  }\n  if (!failed) {\n    policy.approve()\n  }\n}\n\nmodule.exports.docs = 'https://git.io/fhpFc'\n"],"file":"required-stack-tags.js"}